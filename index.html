<!doctype html>
<html lang="it">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Super Tris</title>

    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <!-- Barra superiore online (nascosta di default) -->
    <div id="online-ui" class="online-bar hidden">
      <div class="online-info">
        <span class="status-indicator">
          <span id="status-dot" class="status-dot"></span>
          <span id="connection-status">Offline</span>
        </span>
        <span class="game-code-label">
          Codice: <strong id="current-game-code"></strong>
        </span>
      </div>
      <button class="exit-btn" onclick="exitGame()">âœ• Esci</button>
    </div>

    <header>
      <h1>Super Tris</h1>
      <h2>Giocatore: <span id="giocatore_attuale">O</span></h2>
    </header>
    <main>
      <div id="game-container"></div>
    </main>
    <footer>
      <a href="https://www.github.com/giordanofabrizii">@giordanofabrizii</a>
    </footer>

    <!-- Modal Selezione ModalitÃ  -->
    <div id="mode-selection-modal" class="modal-overlay hidden">
      <div class="modal-content">
        <h2>Super Tris</h2>
        <p class="modal-subtitle">Scegli come giocare</p>
        <div class="mode-buttons">
          <button class="mode-btn local-btn" onclick="playLocal()">
            <span class="mode-icon">ğŸ®</span>
            <span class="mode-title">Gioca in Locale</span>
            <span class="mode-desc"
              >Due giocatori sullo stesso dispositivo</span
            >
          </button>
          <button class="mode-btn create-btn" onclick="showCreateGame()">
            <span class="mode-icon">ğŸŒ</span>
            <span class="mode-title">Crea Partita Online</span>
            <span class="mode-desc">Genera un codice per il tuo amico</span>
          </button>
          <button class="mode-btn join-btn" onclick="showJoinGame()">
            <span class="mode-icon">ğŸ”—</span>
            <span class="mode-title">Unisciti a Partita</span>
            <span class="mode-desc">Inserisci il codice partita</span>
          </button>
        </div>
        <button class="text-btn" onclick="mostraRegole()">
          ğŸ“‹ Come si gioca
        </button>
      </div>
    </div>

    <!-- Modal Unisciti a Partita -->
    <div id="join-modal" class="modal-overlay hidden">
      <div class="modal-content">
        <h2>Unisciti a Partita</h2>
        <p class="modal-subtitle">Inserisci il codice ricevuto dal tuo amico</p>
        <input
          type="text"
          id="join-code-input"
          class="code-input"
          placeholder="PS7K-2M9N"
          maxlength="9"
          autocomplete="off"
        />
        <div class="modal-buttons">
          <button class="close-btn" onclick="submitJoinGame()">
            ğŸš€ Connetti
          </button>
          <button
            class="secondary-btn"
            onclick="
              hideModal('join-modal');
              showModeSelection();
            "
          >
            â† Indietro
          </button>
        </div>
      </div>
    </div>

    <!-- Modal In Attesa -->
    <div id="waiting-modal" class="modal-overlay hidden">
      <div class="modal-content">
        <h2>Partita Online</h2>
        <div class="waiting-content">
          <div class="game-code-display">
            <p class="code-label">Codice Partita</p>
            <div class="code-box">
              <span id="game-code-display">----</span>
            </div>
            <button
              class="copy-btn"
              id="copy-code-btn"
              onclick="copyGameCode()"
            >
              ğŸ“‹ Copia Codice
            </button>
          </div>
          <div class="waiting-status">
            <div class="spinner"></div>
            <p id="waiting-message">In attesa dell'avversario...</p>
          </div>
          <p class="waiting-info">
            Condividi questo codice con il tuo amico oppure invia questo link:
            <br />
            <a id="share-link" class="share-link" href="#"></a>
          </p>
        </div>
        <button class="secondary-btn" onclick="exitGame()">Annulla</button>
      </div>
    </div>

    <!-- Modal Spiegazioni -->
    <div id="spiegazioni" class="modal-overlay hidden">
      <div class="modal-content">
        <h2>Regole del Gioco</h2>
        <ol>
          <li>
            <b>Primo turno:</b>
            il primo giocatore puÃ² posizionare il suo simbolo in qualsiasi
            casella del tabellone.
          </li>
          <li>
            <b>Regola del vincolo:</b>
            la casella scelta determina in quale mini-griglia l'avversario dovrÃ 
            giocare. Esempio: se metto la X in basso a destra di una
            mini-griglia, l'avversario dovrÃ  giocare nella mini-griglia in basso
            a destra del tabellone grande.
          </li>
          <li>
            <b>Se una mini-griglia Ã¨ giÃ  vinta o piena:</b>
            L'avversario puÃ² giocare in qualsiasi altra mini-griglia ancora
            aperta.
          </li>
          <li>
            <b>Vittoria di una mini-griglia:</b>
            quando un giocatore completa un tris dentro una mini-griglia,
            conquista quella griglia
          </li>
          <li>
            <b>Fine della partita:</b>
            Vince il giocatore che conquista tre mini-griglie allineate (come in
            un tris normale).
          </li>
          <li>
            Se tutte le mini-griglie vengono completate senza un vincitore, la
            partita termina in pareggio.
          </li>
        </ol>
        <button
          class="close-btn"
          onclick="
            chiudiSpiegazioni();
            showModeSelection();
          "
        >
          Inizia a Giocare!
        </button>
      </div>
    </div>

    <!-- Modal Vittoria -->
    <div id="vittoria" class="modal-overlay hidden">
      <div class="modal-content victory-content">
        <div class="victory-title">ğŸ‰ VITTORIA! ğŸ‰</div>
        <div class="winner-symbol" id="winner-symbol">O</div>
        <div class="victory-subtitle">
          Il giocatore <span id="winner-name">O</span> ha conquistato il Super
          Tris!
        </div>
        <div>
          <button class="close-btn" onclick="nuovaPartita()">
            ğŸ® Nuova Partita
          </button>
          <button class="secondary-btn" onclick="mostraRegole()">
            ğŸ“‹ Rivedi Regole
          </button>
        </div>
      </div>
    </div>

    <script src="./game-logic.js"></script>
    <script src="./multiplayer.js"></script>
  </body>
</html>
